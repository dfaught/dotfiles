#======================================================#
# Boring details
set realname = "Derek Faught"
set use_from = yes
set envelope_from = yes
set attribution = "+++ %n [%D]:"
set include=yes
set indent_string = ""
set text_flowed=yes
set forward_quote=yes
set copy=yes
set delete=yes
set confirmappend=no
set fast_reply=yes
set mime_forward=yes

# Use msmtp rather than sendmail. Check that
# the path is correct for your system:
set sendmail="/usr/bin/msmtp""

# If not set in ~/.bashrc:
set spoolfile = "~/home-ext/Maildir/"
set print_command="/usr/bin/muttprint %s"
set print_split
set print="yes"
set sleep_time = 0
#======================================================#
# Folders

set mbox_type=Maildir
set folder="~/home-ext/Maildir/"      # Local mailboxes stored here
#set record="+sent/"           # Where to store sent messages
set mask="!^\\.[^.]"

# offlineimap generates our mailboxes
source ~/.config/mutt/mailboxes
mailboxes "+trash"
mailboxes "+drafts"

set alias_file=~/dotfiles/.mail-config/.aliases
set sort_alias=alias
set reverse_alias=yes
source $alias_file

#source ~/.config/mutt/crypto

set sort_browser=date    # Sort mailboxes by date

#======================================================#
# What to show and order of headers
ignore *
unignore To: Date: From: User-Agent: \
         Cc: Bcc: Reply-To: Subject: Mail-Followup-To:
hdr_order Date From Subject To CC Bcc

set sort=threads
set sort_browser=reverse-date
set sort_aux=reverse-last-date-received

#unset collapse_unread  # never collapse unread messages
set uncollapse_jump    # jumps to first unread msg of thread on uncollapse

#======================================================#
# which editor do you want to use?
# vim of course!
#set editor="vim \"+set spell\" +"
folder-hook . source ./.mutt/bottom-repyly
folder-hook =Work source ./.mutt/top-reply

set edit_headers=yes      # See the headers when editing

# Odds and ends

set smart_wrap       # Don't wrap mid-word
set pager_context=5  # Retain 5 lines of previous page when scrolling.
set status_on_top    # Status bar on top.
push <show-version>  # Shows mutt version at startup

set duplicate_threads = yes

#email addresses with esc-1 and esc-2. Sets the status bar at the
# top too so you know which from address you're using
set mailcap_path 	= ~/.mutt/mailcap
set implicit_autoview=yes
auto_view text/html
auto_view text/calendar
auto_view text/plain
auto_view text/enriched
auto_view application/zip
auto_view application/7z
auto_view application/rar
auto_view application/tar
auto_view application/tgz
auto_view application/tarz
auto_view application/zip
auto_view application/x-zip-compressed
alternative_order text/html text/calendar text/enriched text/plain

folder-hook =Personal set from = "derek@derekfaught.com"
folder-hook =Personal set postponed="+Personal/Personal-Drafts/"   # Where to store draft messages
folder-hook =Personal set record="+Personal/Personal-Sent/"   # Where to store sent messages
folder-hook =Work set from = "derek.faught@rocketgaming.com"
folder-hook =Work set postponed="+Work/Drafts/"   # Where to store draft messages
folder-hook =Family set from = "dixonfaught@tx.rr.com"
folder-hook =Family set postponed="+drafts/"   # Where to store draft messages
folder-hook =family-mail set from = "dfaught@family-mail.us"
folder-hook =family-mail set postponed="+drafts/"   # Where to store draft messages
folder-hook =family-mail set record="+family-mail/Family-Sent/"   # Where to store sent messages
folder-hook =dfaught set from = "dfaught@tx.rr.com"
folder-hook =dfaught set postponed="+drafts/"   # Where to store draft messages

set mail_check_stats = yes
#
# SIDEBAR STUFF

# Sidebar Patch --------------------------------------
#set sidebar_delim_c   = '‚ùö'
set sidebar_visible = yes
set sidebar_width   = 60
color sidebar_new color45 default
color sidebar_flagged color9 default
set sidebar_format = "%B%?F? [%F]?%* %?N?%N/?%S"
set sidebar_short_path = yes
set sidebar_folder_indent = yes

bind index gg      first-entry
bind index G      last-entry
bind index re     recall-message
bind index,pager r      reply
bind index,pager R      group-reply
bind index,pager K sidebar-prev
bind index,pager J sidebar-next
bind index,pager O sidebar-open
bind index,pager \CO next-unread-mailbox
bind index,pager s save-message
bind index,pager \e<Left> sidebar-toggle-visible
bind index,pager <F5> edit-label
bind pager \ek  previous-undeleted
bind pager \ej  next-undeleted
bind pager k  previous-line
bind pager j  next-line
bind pager gg top
bind pager G  bottom
bind index,pager S vfolder-from-query

#Search Stuff
#set query_command= "~/.mail-config/.mutt/mutt-ldap.pl '%s'"
set query_command= "python2 ~/.mail-config/.mutt/mutt_ldap.py '%s'"
bind editor <Tab> complete-query

# Pager View Options ---------------------------------
set pager_index_lines = 15 # number of index lines to show
set pager_context = 3      # number of context lines to show
set pager_stop             # don't go to next message automatically
set menu_scroll            # scroll in menus
set tilde                  # show tildes like in vim
unset markers              # no ugly plus signs
set mark_old=no
set keywords_legacy=yes
set keywords_standard=yes
set narrow_tree = yes

set date_format = "%F %R %z"
set index_format = "%4C %Z %[%a %b %d %Y %R]     %M %30L (%c) %s      %?y?(%.40Y) ? "

set quote_regexp = "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"

# View attachments properly.
bind attach <return> view-mailcap

set nm_default_uri = "notmuch:///home/derek/home-ext/Maildir"

#======================================================#
# Colours: defaults are a little bleak so experiment!

#source ~/.mutt/mutt-colors-solarized/mutt-colors-solarized-dark-16.muttrc            # In their own file
#source ~/.mutt/mutt-colors-solarized/mutt-colors-solarized-light-16.muttrc            # In their own file
source ~/.mutt/mutt-colors-solarized/mutt-colors-solarized-dark-256.muttrc
#source ~/.mutt/mutt-colors-solarized/mutt-colors-solarized-light-256.muttrc
#source ~/.mutt/colors

set allow_ansi=yes

################################################
# Macrosss
################################################

source ~/.mutt/macros

macro index,pager c "<change-folder>?<toggle-mailboxes>" "open a different folder"
folder-hook =Personal macro index d "<save-message>+trash<enter>" "move message to the trash"
folder-hook =Family macro index d "<save-message>+trash<enter>" "move message to the trash"
folder-hook =family-mail macro index d "<save-message>+trash<enter>" "move message to the trash"
folder-hook =dfaught macro index d "<save-message>+trash<enter>" "move message to the trash"
folder-hook =Work macro index D "<save-message>+trash<enter>" "move message to the trash"

